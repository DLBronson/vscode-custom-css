@echo off
setlocal enabledelayedexpansion

REM Prompt the user for file extensions
set /p fileExtensions=Enter file extensions (comma-separated, e.g., txt, pdf): 

REM Prompt the user for the search directory
set /p searchDirectory=Enter the directory path to search in: 

REM Create the HTML file to store the results
set htmlFilePath=FileList.html
echo ^<html^>^<head^>^<title^>File List^</title^>^</head^>^<body^> > %htmlFilePath%
echo ^<h1^>File List for %searchDirectory%^</h1^> >> %htmlFilePath%
echo ^<ul^> >> %htmlFilePath%

REM Loop through the files and create hyperlinks in the HTML
for /r %searchDirectory% %%F in (%fileExtensions%) do (
    set "link=%%~fF"
    set "link=!link:&=^&!"
    echo ^<li^>^<a href="!link!"^>!link!^</a^>^</li^> >> %htmlFilePath%
)

REM Close the HTML
echo ^</ul^>^</body^>^</html^> >> %htmlFilePath%

echo File list generated and saved to %htmlFilePath%
